#!/usr/bin/env bash
set -euo pipefail

ROOT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
BIN_DIR="${ROOT_DIR}/.bin"
BIN_PATH="${BIN_DIR}/stackctl"

if [[ ! -x "${BIN_PATH}" ]]; then
  mkdir -p "${BIN_DIR}"
  go build -o "${BIN_PATH}" "${ROOT_DIR}/cmd/stackctl"
fi

exec "${BIN_PATH}" "$@"
